{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Jan Nikko\\\\Downloads\\\\crime-map-proto\\\\frontend\\\\src\\\\MapView.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useEffect, useState, useMemo, useCallback } from \"react\";\nimport { MapContainer, TileLayer, LayersControl, useMap, CircleMarker, Tooltip, Circle } from \"react-leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport L from \"leaflet\";\nimport \"leaflet.heat\";\nimport \"./MapView.css\";\nimport { DateTime } from \"./DateTime\";\n\n// Cluster colors\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst getClusterColor = clusterId => {\n  const colors = [\"#FF6B6B\", \"#4ECDC4\", \"#45B7D1\", \"#96CEB4\", \"#FFEAA7\", \"#DDA0DD\", \"#98D8C8\", \"#F7DC6F\", \"#BB8FCE\", \"#85C1E9\", \"#F8C471\", \"#82E0AA\", \"#F1948A\", \"#85C1E9\", \"#D7DBDD\"];\n  return clusterId === -1 ? \"#95A5A6\" : colors[clusterId % colors.length];\n};\n\n// ðŸ”’ San Fernando bounding box\nconst sanFernandoBounds = [[14.9666, 120.5874],\n// Southwest\n[15.0858, 120.7722] // Northeast\n];\n\n// Heatmap layer\nfunction ClusteredHeatmapLayer({\n  accidentData,\n  showHeatmap\n}) {\n  _s();\n  const map = useMap();\n  const heatmapPoints = useMemo(() => {\n    if (!accidentData || !showHeatmap) return [];\n    return accidentData.features.filter(f => f.properties.type === \"accident_point\").map(({\n      geometry,\n      properties\n    }) => {\n      if (!geometry || !geometry.coordinates) return null;\n      const [lng, lat] = geometry.coordinates;\n      if (typeof lat !== \"number\" || typeof lng !== \"number\") return null;\n      let intensity = 0.5;\n      if (properties.severity) {\n        const severityMap = {\n          Critical: 1.0,\n          High: 0.8,\n          Medium: 0.6,\n          Low: 0.4,\n          Minor: 0.2\n        };\n        intensity = severityMap[properties.severity] || 0.5;\n      }\n      return [lat, lng, intensity];\n    }).filter(Boolean);\n  }, [accidentData, showHeatmap]);\n  useEffect(() => {\n    if (!showHeatmap || heatmapPoints.length === 0) return;\n    const heatLayer = L.heatLayer(heatmapPoints, {\n      radius: 25,\n      blur: 15,\n      maxZoom: 18,\n      gradient: {\n        0.2: \"blue\",\n        0.4: \"cyan\",\n        0.6: \"lime\",\n        0.8: \"yellow\",\n        1.0: \"red\"\n      },\n      minOpacity: 0.4\n    });\n    map.addLayer(heatLayer);\n    return () => map.removeLayer(heatLayer);\n  }, [map, heatmapPoints, showHeatmap]);\n  return null;\n}\n\n// Cluster circles\n_s(ClusteredHeatmapLayer, \"dFqsgshkKdpP12/hOBdnlWxWUjc=\", false, function () {\n  return [useMap];\n});\n_c = ClusteredHeatmapLayer;\nfunction ClusterCenters({\n  clusterCenters,\n  showClusters\n}) {\n  if (!showClusters || !clusterCenters) return null;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: clusterCenters.map(f => {\n      var _properties$barangays;\n      const [lng, lat] = f.geometry.coordinates;\n      const {\n        properties\n      } = f;\n      const color = getClusterColor(properties.cluster_id);\n      const radius = Math.min(Math.sqrt(properties.accident_count) * 30, 200);\n      return /*#__PURE__*/_jsxDEV(Circle, {\n        center: [lat, lng],\n        radius: radius,\n        pathOptions: {\n          fillColor: color,\n          fillOpacity: 0.15,\n          color: color,\n          weight: 2,\n          opacity: 0.6\n        },\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          direction: \"top\",\n          offset: [0, -10],\n          opacity: 1,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mapview-tooltip\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"b\", {\n                children: [\"Cluster #\", properties.cluster_id]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 115,\n                columnNumber: 22\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                children: \"Accidents:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 116,\n                columnNumber: 22\n              }, this), \" \", properties.accident_count]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                children: \"Location:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 117,\n                columnNumber: 22\n              }, this), \" \", lat.toFixed(4), \", \", lng.toFixed(4)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 17\n            }, this), ((_properties$barangays = properties.barangays) === null || _properties$barangays === void 0 ? void 0 : _properties$barangays.length) > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                children: \"Areas:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 21\n              }, this), \" \", properties.barangays.slice(0, 2).join(\", \"), properties.barangays.length > 2 ? \"...\" : \"\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 13\n        }, this)\n      }, `cluster-${properties.cluster_id}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 11\n      }, this);\n    })\n  }, void 0, false);\n}\n\n// Accident markers\n_c2 = ClusterCenters;\nfunction AccidentMarkers({\n  accidentPoints,\n  showMarkers\n}) {\n  if (!showMarkers || !accidentPoints) return null;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: accidentPoints.map((f, idx) => {\n      const {\n        geometry,\n        properties\n      } = f;\n      const [lng, lat] = geometry.coordinates;\n      const clusterColor = getClusterColor(properties.cluster);\n      const isNoise = properties.cluster === -1;\n      return /*#__PURE__*/_jsxDEV(CircleMarker, {\n        center: [lat, lng],\n        radius: isNoise ? 3 : 4,\n        pathOptions: {\n          fillColor: clusterColor,\n          fillOpacity: isNoise ? 0.4 : 0.7,\n          color: clusterColor,\n          weight: 1,\n          opacity: isNoise ? 0.6 : 0.9\n        },\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          direction: \"top\",\n          offset: [0, -5],\n          opacity: 1,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mapview-tooltip\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                children: \"Cluster:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 22\n              }, this), \" \", isNoise ? \"Noise\" : `#${properties.cluster}`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                children: \"Type:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 22\n              }, this), \" \", properties.offensetype || \"N/A\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                children: \"Severity:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 22\n              }, this), \" \", properties.severity || \"N/A\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 17\n            }, this), properties.barangay && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                children: \"Area:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 46\n              }, this), \" \", properties.barangay]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 13\n        }, this)\n      }, `accident-${idx}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 11\n      }, this);\n    })\n  }, void 0, false);\n}\n\n// Main component\n_c3 = AccidentMarkers;\nexport default function MapView() {\n  _s2();\n  const [accidentData, setAccidentData] = useState(null);\n  const [showClusters, setShowClusters] = useState(true);\n  const [showHeatmap, setShowHeatmap] = useState(true);\n  const [showMarkers, setShowMarkers] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const {\n    accidentPoints,\n    clusterCenters,\n    stats\n  } = useMemo(() => {\n    if (!accidentData) return {\n      accidentPoints: [],\n      clusterCenters: [],\n      stats: null\n    };\n    const accidents = accidentData.features.filter(f => f.properties.type === \"accident_point\");\n    const clusters = accidentData.features.filter(f => f.properties.type === \"cluster_center\");\n    return {\n      accidentPoints: accidents,\n      clusterCenters: clusters,\n      stats: {\n        totalAccidents: accidents.length,\n        totalClusters: clusters.length,\n        noisePoints: accidents.filter(f => f.properties.cluster === -1).length\n      }\n    };\n  }, [accidentData]);\n  useEffect(() => {\n    async function fetchData() {\n      setLoading(true);\n      try {\n        var _data$features;\n        const res = await fetch(\"https://crime-map-proto.onrender.com/data/accidents_clustered.geojson\");\n        if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);\n        const data = await res.json();\n        setAccidentData(data);\n        console.log(\"Loaded clustered data:\", (_data$features = data.features) === null || _data$features === void 0 ? void 0 : _data$features.length, \"features\");\n      } catch (err) {\n        console.error(\"Failed to load clustered GeoJSON:\", err);\n      } finally {\n        setLoading(false);\n      }\n    }\n    fetchData();\n  }, []);\n  const handleToggle = useCallback(setter => e => setter(e.target.checked), []);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"scroll-wrapper\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mapview-container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"page-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n            className: \"page-title\",\n            children: \"Loading Clustered Data...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DateTime, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"scroll-wrapper\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mapview-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"page-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n          className: \"page-title\",\n          children: \"Clustered Accident Heatmap\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(DateTime, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"controls-panel\",\n        style: {\n          padding: \"8px 12px\",\n          marginBottom: \"8px\",\n          backgroundColor: \"#f8f9fa\",\n          border: \"1px solid #ddd\",\n          borderRadius: \"6px\",\n          display: \"flex\",\n          gap: \"16px\",\n          alignItems: \"center\",\n          fontSize: \"14px\",\n          boxShadow: \"0 1px 3px rgba(0,0,0,0.1)\",\n          color: \"#000\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"4px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: showHeatmap,\n            onChange: handleToggle(setShowHeatmap)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 9\n          }, this), \" Heatmap\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"4px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: showClusters,\n            onChange: handleToggle(setShowClusters)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 9\n          }, this), \" Clusters\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"4px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: showMarkers,\n            onChange: handleToggle(setShowMarkers)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 9\n          }, this), \" Points\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 7\n        }, this), stats && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stats\",\n          style: {\n            marginLeft: \"auto\",\n            fontSize: \"12px\",\n            color: \"#000000ff\",\n            fontStyle: \"italic\"\n          },\n          children: [stats.totalAccidents, \" accidents \\u2022 \", stats.totalClusters, \" clusters \\u2022 \", stats.noisePoints, \" noise\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"map-card\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mapview-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(MapContainer, {\n            center: [15.0306, 120.6845],\n            zoom: 14,\n            minZoom: 12,\n            maxZoom: 18,\n            scrollWheelZoom: true,\n            className: \"mapview-map\",\n            preferCanvas: true,\n            updateWhenZooming: false,\n            updateWhenIdle: true,\n            maxBounds: sanFernandoBounds // ðŸ”’ Lock map to San Fernando\n            ,\n            maxBoundsViscosity: 1.0 // 1 = hard lock\n            ,\n            children: [/*#__PURE__*/_jsxDEV(LayersControl, {\n              position: \"topright\",\n              children: [/*#__PURE__*/_jsxDEV(LayersControl.BaseLayer, {\n                checked: true,\n                name: \"Light\",\n                children: /*#__PURE__*/_jsxDEV(TileLayer, {\n                  url: \"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png\",\n                  attribution: \"\\xA9 CartoDB\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 300,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 299,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(LayersControl.BaseLayer, {\n                name: \"Streets\",\n                children: /*#__PURE__*/_jsxDEV(TileLayer, {\n                  url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n                  attribution: \"\\xA9 OpenStreetMap contributors\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 306,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 305,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(LayersControl.BaseLayer, {\n                name: \"Dark\",\n                children: /*#__PURE__*/_jsxDEV(TileLayer, {\n                  url: \"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\",\n                  attribution: \"\\xA9 CartoDB\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 312,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 311,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ClusteredHeatmapLayer, {\n              accidentData: accidentData,\n              showHeatmap: showHeatmap\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ClusterCenters, {\n              clusterCenters: clusterCenters,\n              showClusters: showClusters\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(AccidentMarkers, {\n              accidentPoints: accidentPoints,\n              showMarkers: showMarkers\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 234,\n    columnNumber: 5\n  }, this);\n}\n_s2(MapView, \"ASb9k4rM7ZhGKi8buIvlJ8JntCY=\");\n_c4 = MapView;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"ClusteredHeatmapLayer\");\n$RefreshReg$(_c2, \"ClusterCenters\");\n$RefreshReg$(_c3, \"AccidentMarkers\");\n$RefreshReg$(_c4, \"MapView\");","map":{"version":3,"names":["useEffect","useState","useMemo","useCallback","MapContainer","TileLayer","LayersControl","useMap","CircleMarker","Tooltip","Circle","L","DateTime","jsxDEV","_jsxDEV","Fragment","_Fragment","getClusterColor","clusterId","colors","length","sanFernandoBounds","ClusteredHeatmapLayer","accidentData","showHeatmap","_s","map","heatmapPoints","features","filter","f","properties","type","geometry","coordinates","lng","lat","intensity","severity","severityMap","Critical","High","Medium","Low","Minor","Boolean","heatLayer","radius","blur","maxZoom","gradient","minOpacity","addLayer","removeLayer","_c","ClusterCenters","clusterCenters","showClusters","children","_properties$barangays","color","cluster_id","Math","min","sqrt","accident_count","center","pathOptions","fillColor","fillOpacity","weight","opacity","direction","offset","className","fileName","_jsxFileName","lineNumber","columnNumber","toFixed","barangays","slice","join","_c2","AccidentMarkers","accidentPoints","showMarkers","idx","clusterColor","cluster","isNoise","offensetype","barangay","_c3","MapView","_s2","setAccidentData","setShowClusters","setShowHeatmap","setShowMarkers","loading","setLoading","stats","accidents","clusters","totalAccidents","totalClusters","noisePoints","fetchData","_data$features","res","fetch","ok","Error","status","data","json","console","log","err","error","handleToggle","setter","e","target","checked","style","padding","marginBottom","backgroundColor","border","borderRadius","display","gap","alignItems","fontSize","boxShadow","onChange","marginLeft","fontStyle","zoom","minZoom","scrollWheelZoom","preferCanvas","updateWhenZooming","updateWhenIdle","maxBounds","maxBoundsViscosity","position","BaseLayer","name","url","attribution","_c4","$RefreshReg$"],"sources":["C:/Users/Jan Nikko/Downloads/crime-map-proto/frontend/src/MapView.js"],"sourcesContent":["import { useEffect, useState, useMemo, useCallback } from \"react\";\r\nimport {\r\n  MapContainer,\r\n  TileLayer,\r\n  LayersControl,\r\n  useMap,\r\n  CircleMarker,\r\n  Tooltip,\r\n  Circle,\r\n} from \"react-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport L from \"leaflet\";\r\nimport \"leaflet.heat\";\r\nimport \"./MapView.css\";\r\nimport { DateTime } from \"./DateTime\";\r\n\r\n// Cluster colors\r\nconst getClusterColor = (clusterId) => {\r\n  const colors = [\r\n    \"#FF6B6B\", \"#4ECDC4\", \"#45B7D1\", \"#96CEB4\", \"#FFEAA7\",\r\n    \"#DDA0DD\", \"#98D8C8\", \"#F7DC6F\", \"#BB8FCE\", \"#85C1E9\",\r\n    \"#F8C471\", \"#82E0AA\", \"#F1948A\", \"#85C1E9\", \"#D7DBDD\",\r\n  ];\r\n  return clusterId === -1 ? \"#95A5A6\" : colors[clusterId % colors.length];\r\n};\r\n\r\n// ðŸ”’ San Fernando bounding box\r\nconst sanFernandoBounds = [\r\n  [14.9666, 120.5874], // Southwest\r\n  [15.0858, 120.7722], // Northeast\r\n];\r\n\r\n// Heatmap layer\r\nfunction ClusteredHeatmapLayer({ accidentData, showHeatmap }) {\r\n  const map = useMap();\r\n\r\n  const heatmapPoints = useMemo(() => {\r\n    if (!accidentData || !showHeatmap) return [];\r\n\r\n    return accidentData.features\r\n      .filter((f) => f.properties.type === \"accident_point\")\r\n      .map(({ geometry, properties }) => {\r\n        if (!geometry || !geometry.coordinates) return null;\r\n        const [lng, lat] = geometry.coordinates;\r\n        if (typeof lat !== \"number\" || typeof lng !== \"number\") return null;\r\n\r\n        let intensity = 0.5;\r\n        if (properties.severity) {\r\n          const severityMap = {\r\n            Critical: 1.0,\r\n            High: 0.8,\r\n            Medium: 0.6,\r\n            Low: 0.4,\r\n            Minor: 0.2,\r\n          };\r\n          intensity = severityMap[properties.severity] || 0.5;\r\n        }\r\n\r\n        return [lat, lng, intensity];\r\n      })\r\n      .filter(Boolean);\r\n  }, [accidentData, showHeatmap]);\r\n\r\n  useEffect(() => {\r\n    if (!showHeatmap || heatmapPoints.length === 0) return;\r\n\r\n    const heatLayer = L.heatLayer(heatmapPoints, {\r\n      radius: 25,\r\n      blur: 15,\r\n      maxZoom: 18,\r\n      gradient: {\r\n        0.2: \"blue\",\r\n        0.4: \"cyan\",\r\n        0.6: \"lime\",\r\n        0.8: \"yellow\",\r\n        1.0: \"red\",\r\n      },\r\n      minOpacity: 0.4,\r\n    });\r\n\r\n    map.addLayer(heatLayer);\r\n    return () => map.removeLayer(heatLayer);\r\n  }, [map, heatmapPoints, showHeatmap]);\r\n\r\n  return null;\r\n}\r\n\r\n// Cluster circles\r\nfunction ClusterCenters({ clusterCenters, showClusters }) {\r\n  if (!showClusters || !clusterCenters) return null;\r\n\r\n  return (\r\n    <>\r\n      {clusterCenters.map((f) => {\r\n        const [lng, lat] = f.geometry.coordinates;\r\n        const { properties } = f;\r\n        const color = getClusterColor(properties.cluster_id);\r\n        const radius = Math.min(Math.sqrt(properties.accident_count) * 30, 200);\r\n\r\n        return (\r\n          <Circle\r\n            key={`cluster-${properties.cluster_id}`}\r\n            center={[lat, lng]}\r\n            radius={radius}\r\n            pathOptions={{\r\n              fillColor: color,\r\n              fillOpacity: 0.15,\r\n              color: color,\r\n              weight: 2,\r\n              opacity: 0.6,\r\n            }}\r\n          >\r\n            <Tooltip direction=\"top\" offset={[0, -10]} opacity={1}>\r\n              <div className=\"mapview-tooltip\">\r\n                <div><b>Cluster #{properties.cluster_id}</b></div>\r\n                <div><b>Accidents:</b> {properties.accident_count}</div>\r\n                <div><b>Location:</b> {lat.toFixed(4)}, {lng.toFixed(4)}</div>\r\n                {properties.barangays?.length > 0 && (\r\n                  <div>\r\n                    <b>Areas:</b> {properties.barangays.slice(0, 2).join(\", \")}\r\n                    {properties.barangays.length > 2 ? \"...\" : \"\"}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </Tooltip>\r\n          </Circle>\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n}\r\n\r\n// Accident markers\r\nfunction AccidentMarkers({ accidentPoints, showMarkers }) {\r\n  if (!showMarkers || !accidentPoints) return null;\r\n\r\n  return (\r\n    <>\r\n      {accidentPoints.map((f, idx) => {\r\n        const { geometry, properties } = f;\r\n        const [lng, lat] = geometry.coordinates;\r\n        const clusterColor = getClusterColor(properties.cluster);\r\n        const isNoise = properties.cluster === -1;\r\n\r\n        return (\r\n          <CircleMarker\r\n            key={`accident-${idx}`}\r\n            center={[lat, lng]}\r\n            radius={isNoise ? 3 : 4}\r\n            pathOptions={{\r\n              fillColor: clusterColor,\r\n              fillOpacity: isNoise ? 0.4 : 0.7,\r\n              color: clusterColor,\r\n              weight: 1,\r\n              opacity: isNoise ? 0.6 : 0.9,\r\n            }}\r\n          >\r\n            <Tooltip direction=\"top\" offset={[0, -5]} opacity={1}>\r\n              <div className=\"mapview-tooltip\">\r\n                <div><b>Cluster:</b> {isNoise ? \"Noise\" : `#${properties.cluster}`}</div>\r\n                <div><b>Type:</b> {properties.offensetype || \"N/A\"}</div>\r\n                <div><b>Severity:</b> {properties.severity || \"N/A\"}</div>\r\n                {properties.barangay && <div><b>Area:</b> {properties.barangay}</div>}\r\n              </div>\r\n            </Tooltip>\r\n          </CircleMarker>\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n}\r\n\r\n// Main component\r\nexport default function MapView() {\r\n  const [accidentData, setAccidentData] = useState(null);\r\n  const [showClusters, setShowClusters] = useState(true);\r\n  const [showHeatmap, setShowHeatmap] = useState(true);\r\n  const [showMarkers, setShowMarkers] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const { accidentPoints, clusterCenters, stats } = useMemo(() => {\r\n    if (!accidentData) return { accidentPoints: [], clusterCenters: [], stats: null };\r\n\r\n    const accidents = accidentData.features.filter((f) => f.properties.type === \"accident_point\");\r\n    const clusters = accidentData.features.filter((f) => f.properties.type === \"cluster_center\");\r\n\r\n    return {\r\n      accidentPoints: accidents,\r\n      clusterCenters: clusters,\r\n      stats: {\r\n        totalAccidents: accidents.length,\r\n        totalClusters: clusters.length,\r\n        noisePoints: accidents.filter((f) => f.properties.cluster === -1).length,\r\n      },\r\n    };\r\n  }, [accidentData]);\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      setLoading(true);\r\n      try {\r\n        const res = await fetch(\r\n          \"https://crime-map-proto.onrender.com/data/accidents_clustered.geojson\"\r\n        );\r\n        if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);\r\n        const data = await res.json();\r\n        setAccidentData(data);\r\n        console.log(\"Loaded clustered data:\", data.features?.length, \"features\");\r\n      } catch (err) {\r\n        console.error(\"Failed to load clustered GeoJSON:\", err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    fetchData();\r\n  }, []);\r\n\r\n  const handleToggle = useCallback((setter) => (e) => setter(e.target.checked), []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"scroll-wrapper\">\r\n        <div className=\"mapview-container\">\r\n          <div className=\"page-header\">\r\n            <h6 className=\"page-title\">Loading Clustered Data...</h6>\r\n            <DateTime />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"scroll-wrapper\">\r\n      <div className=\"mapview-container\">\r\n        <div className=\"page-header\">\r\n          <h6 className=\"page-title\">Clustered Accident Heatmap</h6>\r\n          <DateTime />\r\n        </div>\r\n\r\n        {/* Controls */}\r\n        <div \r\n        className=\"controls-panel\"\r\n        style={{\r\n        padding: \"8px 12px\",\r\n        marginBottom: \"8px\",\r\n        backgroundColor: \"#f8f9fa\",\r\n        border: \"1px solid #ddd\",\r\n        borderRadius: \"6px\",\r\n        display: \"flex\",\r\n        gap: \"16px\",\r\n        alignItems: \"center\",\r\n        fontSize: \"14px\",\r\n        boxShadow: \"0 1px 3px rgba(0,0,0,0.1)\",\r\n        color: \"#000\"\r\n      }}\r\n    >\r\n      <label style={{ display: \"flex\", alignItems: \"center\", gap: \"4px\" }}>\r\n        <input type=\"checkbox\" checked={showHeatmap} onChange={handleToggle(setShowHeatmap)} /> Heatmap\r\n      </label>\r\n      <label style={{ display: \"flex\", alignItems: \"center\", gap: \"4px\" }}>\r\n        <input type=\"checkbox\" checked={showClusters} onChange={handleToggle(setShowClusters)} /> Clusters\r\n      </label>\r\n      <label style={{ display: \"flex\", alignItems: \"center\", gap: \"4px\" }}>\r\n        <input type=\"checkbox\" checked={showMarkers} onChange={handleToggle(setShowMarkers)} /> Points\r\n      </label>\r\n      {stats && (\r\n        <div \r\n          className=\"stats\"\r\n          style={{\r\n            marginLeft: \"auto\",\r\n            fontSize: \"12px\",\r\n            color: \"#000000ff\",\r\n            fontStyle: \"italic\"\r\n          }}\r\n        >\r\n          {stats.totalAccidents} accidents â€¢ {stats.totalClusters} clusters â€¢ {stats.noisePoints} noise\r\n        </div>\r\n      )}\r\n    </div>\r\n\r\n        {/* Map */}\r\n        <div className=\"map-card\">\r\n          <div className=\"mapview-wrapper\">\r\n            <MapContainer\r\n              center={[15.0306, 120.6845]}\r\n              zoom={14}\r\n              minZoom={12}\r\n              maxZoom={18}\r\n              scrollWheelZoom={true}\r\n              className=\"mapview-map\"\r\n              preferCanvas={true}\r\n              updateWhenZooming={false}\r\n              updateWhenIdle={true}\r\n              maxBounds={sanFernandoBounds}  // ðŸ”’ Lock map to San Fernando\r\n              maxBoundsViscosity={1.0}       // 1 = hard lock\r\n            >\r\n              <LayersControl position=\"topright\">\r\n                <LayersControl.BaseLayer checked name=\"Light\">\r\n                  <TileLayer\r\n                    url=\"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png\"\r\n                    attribution=\"Â© CartoDB\"\r\n                  />\r\n                </LayersControl.BaseLayer>\r\n                <LayersControl.BaseLayer name=\"Streets\">\r\n                  <TileLayer\r\n                    url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                    attribution=\"Â© OpenStreetMap contributors\"\r\n                  />\r\n                </LayersControl.BaseLayer>\r\n                <LayersControl.BaseLayer name=\"Dark\">\r\n                  <TileLayer\r\n                    url=\"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\r\n                    attribution=\"Â© CartoDB\"\r\n                  />\r\n                </LayersControl.BaseLayer>\r\n              </LayersControl>\r\n\r\n              <ClusteredHeatmapLayer accidentData={accidentData} showHeatmap={showHeatmap} />\r\n              <ClusterCenters clusterCenters={clusterCenters} showClusters={showClusters} />\r\n              <AccidentMarkers accidentPoints={accidentPoints} showMarkers={showMarkers} />\r\n            </MapContainer>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}